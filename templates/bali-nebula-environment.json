{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "This cloud formation template is used to setup the Bali Nebula environment.",
  "Resources": {
    "NebulaDomain": {
      "Type": "AWS::ApiGateway::DomainName",
      "Properties": {
        "RegionalCertificateArn": "arn:aws:acm:us-east-1:821699068808:certificate/066d667f-ec36-486f-9fca-42136deb31bd",
        "DomainName": "bali-nebula.net",
        "EndpointConfiguration" : {
          "Types" : [ "REGIONAL" ]
        }
      }
    },
    "NebulaRouting": {
      "Type" : "AWS::Route53::RecordSet",
      "DependsOn": [ "NebulaDomain" ],
      "Properties" : {
        "Name": "bali-nebula.net.",
        "Comment" : "Route all service requests to the service API gateway endpoint,",
        "Type" : "A",
        "HostedZoneName" : "bali-nebula.net.",
        "AliasTarget" : {
          "DNSName": { "Fn::GetAtt": [ "NebulaDomain", "RegionalDomainName" ] },
          "EvaluateTargetHealth" : false,
          "HostedZoneId" : "Z1UJRXOUMOOFQ8"
        }
      }
    }
  }
}
